<!DOCTYPE html>
<html>
  <head>
    <title>Expense Tracker - Google Sheets</title>
    <style>
      body { font-family: Arial, sans-serif; }
      table { margin-top: 16px; border-collapse: collapse; }
      th, td { padding: 8px 16px; border: 1px solid #ccc; }
      tfoot { font-weight: bold; background: #f9f9f9; }
      #totalBox { margin-top: 20px; font-size: 1.2em; }
    </style>
  </head>
  <body>
    <h1>My Expenses</h1>
    <button onclick="loadExpenses()">Load Expenses</button>
    <table id="expenseTable"></table>
    <div id="totalBox"></div>
    <script>
      function loadExpenses() {
        const sheetUrl = "https://docs.google.com/spreadsheets/d/15Y065-EpGQ-698FJNdmk92VDSdqchLfOGe7IPsYa_2o/export?format=csv";
        fetch(sheetUrl)
          .then(response => response.text())
          .then(csv => {
            const rows = csv.split('\n').map(row => row.split(','));
            const table = document.getElementById('expenseTable');
            table.innerHTML = '';
            let total = 0;
            rows.forEach((row, i) => {
              const tr = document.createElement('tr');
              row.forEach((cell, j) => {
                const td = document.createElement(i === 0 ? 'th' : 'td');
                td.textContent = cell;
                tr.appendChild(td);
                // If not header and this is the Amount column (index 3), add to total
                if (i > 0 && j === 3) {
                  const val = parseFloat(cell);
                  if (!isNaN(val)) total += val;
                }
              });
              table.appendChild(tr);
            });
            // Show total below the table
            document.getElementById('totalBox').textContent = "Total Spent: $" + total.toFixed(2);
          });
      }
    </script>
  </body>
</html>
